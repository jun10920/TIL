# Ch15 백트래킹

# 백트래킹의 개요

- 문제의 해가 될 수 있는 후보를 찾고, 해가 될 수 있는 조건을 충족하지 못하는 후보는 제거하면서 최종 해를 찾는 기법
- 여러 후보해 중 특정 조건을 충족시키는 모든 해를 찾는 알고리즘
  - 모든 해
    - 답이 되는 여러 개의 해
  - 후보해
    - 해가 될 수 있는 가능성을 가지고 있는 부분해의 조합
- 예시 - 미로 탐색

1. 갈림길이 나오면 무조건 왼쪽 길부터 들어간다
2. 막다른 곳이 나오면 갈라진 길목으로 나와 그다음 길을 시도한다.
3. 목표에 도달하거나 모든 경로를 탐색할 때까지 1~2단계를 반복한다.

- 탐색 알고리즘과 비슷하지만 탐색은 모든 노드를 방문하는 것이 목적이고, 백트래킹은 원하는 노드를 최소한의 길이의 경로를 거쳐서 찾는 것이 중요하다.
- 백트래킹이 다루는 문제들은 다양한 후보해를 갖고 있는데 이 후보해들은 부분해를 가지고 있어 트리 형태로 나타낼 수 있다.

### 백트래킹 과정

1. 뿌리에서부터 시작한다 (뿌리도 하나의 부분해)
2. 현재 위치한 부분해에서 선택 가능한 다음 부분해의 목록을 얻는다
3. 2에서 얻은 부분해의 목록을 하나씩 방문한다
4. 방문한 부분해가 해가 될 수 있는 조건을 만족하면 2~3을 수행하고 아니라면 다시 이전 부분해로 돌아가 다른 부분해를 시도한다.
5. 최종해를 얻거나 모든 경우의 수를 확인할 때까지 2~4단계를 반복한다.

# 미로 탈출로 찾기

- 백트래킹의 과정도 반복하는 부분이 있으니 재귀함수로 나타내기 좋다.
- 대신 탐색을 반복하는 것 말고, 다시 되돌아나오는 백트래킹은 어떻게 구현하면 좋을까?
- 백트래킹으로 처리해야 하는 경우는
  - 현재 시도 중인 부분 후보해가 해가 될 수 있는 조건을 만족하지 못하는 경우
  - 최종해를 확보한 경우
- 백트래킹으로 처리하는 것은 함수를 반환하는 것으로 이루어진다.

# X개의 퀸 문제

- N\*N 크기의 체스 판에서 X개의 퀸을 서로 공격할 수 없게 배치하는 문제
- 예로 8\*8크기 체스 판에서 8개의 퀸을 배치한다면 64C8이므로 64!/8!(64-8)!의 후보해를 가진다.
- 대충 44억 개로, 이중 모든 해는 92개이다.
- 결국 문제는 44억 개의 후보해 중에서 92개의 실제해를 찾으라는 문제다.
- 이것 역시 첫 번째 행의 첫 번째 열부터 퀸을 놓고 각 케이스에 맞게 다음 행에 맞춰서 조건을 맞춰보다가 만족하지 않으면 다시 첫번째 행으로 백트래킹하고 다시 두 번째 열부터 퀸을 놓으면 된다.
